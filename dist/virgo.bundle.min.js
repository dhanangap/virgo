!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Virgo=e():t.Virgo=e()}(self,(function(){return(()=>{"use strict";var t={};(t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})})(t);class e{constructor(t){this.parent=t,this.startPos=0,this.amount=0,this.threshold=.15,this.isDragging=!1,this.parent.element.addEventListener("mousedown",(t=>{this.initDrag(t.pageX)})),this.parent.element.addEventListener("mousemove",(t=>{this.drag(t.pageX)})),this.parent.element.addEventListener("mouseup",(()=>{this.stopDrag()})),this.parent.element.addEventListener("mouseleave",(()=>{this.stopDrag()})),this.parent.element.addEventListener("touchstart",(t=>{this.initDrag(t.touches[0].clientX)})),this.parent.element.addEventListener("touchmove",(t=>{this.drag(t.touches[0].clientX)})),this.parent.element.addEventListener("touchend",(()=>{this.stopDrag()}))}initDrag(t){this.isDragging=!0,this.parent.parent.element.classList.add("dragging"),this.startPos=t,this.activePage=this.parent.activePage,this.previousPage=this.parent.previousPage,this.nextPage=this.parent.nextPage;const e=this.parent.element.getBoundingClientRect(),s=this.activePage.element.getBoundingClientRect(),i=this.previousPage.element.getBoundingClientRect();this.nextPage.element.getBoundingClientRect(),this.activePageStartPos=s.left-e.left,this.previousPageStartPos=this.activePageStartPos-i.width,this.nextPageStartPos=this.activePageStartPos+s.width,this.containerStartHeight=e.height,this.containerPreviousHeight=this.previousPage.element.getBoundingClientRect().height,this.containerNextHeight=this.nextPage.element.getBoundingClientRect().height,this.parent.element.style.userSelect="none",this.parent.parent.stopAutoplay()}drag(t){if(this.isDragging){this.amount=t-this.startPos;const e=this.amount/this.activePage.element.getBoundingClientRect().width;let s=0;s=e<0?this.containerNextHeight>this.containerStartHeight?this.containerStartHeight+Math.abs((this.containerNextHeight-this.containerStartHeight)*e):this.containerStartHeight-Math.abs((this.containerStartHeight-this.containerNextHeight)*e):this.containerPreviousHeight>this.containerStartHeight?this.containerStartHeight+Math.abs((this.containerPreviousHeight-this.containerStartHeight)*e):this.containerStartHeight-Math.abs((this.containerStartHeight-this.containerPreviousHeight)*e),this.parent.element.style.height=`${s}px`,this.activePage.element.style.transform=`translateX(${this.activePageStartPos+this.amount}px)`,this.previousPage.element.style.transform=`translateX(${this.previousPageStartPos+this.amount}px)`,this.nextPage.element.style.transform=`translateX(${this.nextPageStartPos+this.amount}px)`}}stopDrag(){if(this.isDragging){this.parent.parent.element.classList.remove("dragging");const t=this.activePage.element.getBoundingClientRect().width;let e=0;this.amount>=t*this.threshold?e=-1:this.amount<=t*this.threshold*-1&&(e=1),this.isDragging=!1,this.amount=0,this.startPos=0;const s=300,i={duration:s,easing:"ease-out"};if(0===e)setTimeout((()=>{this.parent.element.style.height=`${this.containerStartHeight}px`,this.activePage.element.style.transform=`translateX(${this.activePageStartPos}px)`,this.previousPage.element.style.transform=`translateX(${this.previousPageStartPos}px)`,this.nextPage.element.style.transform=`translateX(${this.nextPageStartPos}px)`}),s-10),setTimeout((()=>{this.parent.element.style.height="",this.activePage.element.style.transform="",this.previousPage.element.style.transform="",this.nextPage.element.style.transform=""}),s+10),this.parent.element.animate([{height:this.parent.element.style.height},{height:`${this.containerStartHeight}px`}],i),this.activePage.element.animate([{transform:this.activePage.element.style.transform},{transform:`translateX(${this.activePageStartPos}px)`}],i),this.previousPage.element.animate([{transform:this.previousPage.element.style.transform},{transform:`translateX(${this.previousPageStartPos}px)`}],i),this.nextPage.element.animate([{transform:this.nextPage.element.style.transform},{transform:`translateX(${this.nextPageStartPos}px)`}],i);else if(1===e)setTimeout((()=>{this.parent.element.style.height=`${this.containerNextHeight}px`,this.activePage.element.style.transform=`translateX(${this.activePageStartPos-t}px)`,this.previousPage.element.style.transform=`translateX(${this.previousPageStartPos-t}px)`,this.nextPage.element.style.transform=`translateX(${this.nextPageStartPos-t}px)`}),s-10),setTimeout((()=>{this.parent.activePageIndex=this.parent.nextPageIndex,this.parent.element.style.height="",this.activePage.element.style.transform="",this.previousPage.element.style.transform="",this.nextPage.element.style.transform=""}),s+10),this.parent.element.animate([{height:this.activePage.element.style.height},{height:`${this.containerNextHeight}px`}],i),this.activePage.element.animate([{transform:this.activePage.element.style.transform},{transform:`translateX(${this.activePageStartPos-t}px)`}],i),this.previousPage.element.animate([{transform:this.previousPage.element.style.transform},{transform:`translateX(${this.previousPageStartPos-t}px)`}],i),this.nextPage.element.animate([{transform:this.nextPage.element.style.transform},{transform:`translateX(${this.nextPageStartPos-t}px)`}],i);else if(-1===e){const t=this.activePage.element.getBoundingClientRect().width;setTimeout((()=>{this.parent.element.style.height=`${this.containerPreviousHeight}px`,this.activePage.element.style.transform=`translateX(${this.activePageStartPos+t}px)`,this.previousPage.element.style.transform=`translateX(${this.previousPageStartPos+t}px)`,this.nextPage.element.style.transform=`translateX(${this.nextPageStartPos+t}px)`}),s-10),setTimeout((()=>{this.parent.activePageIndex=this.parent.previousPageIndex,this.parent.element.style.height="",this.activePage.element.style.transform="",this.previousPage.element.style.transform="",this.nextPage.element.style.transform=""}),s+10),this.parent.element.animate([{height:this.activePage.element.style.height},{height:`${this.containerPreviousHeight}px`}],i),this.activePage.element.animate([{transform:this.activePage.element.style.transform},{transform:`translateX(${this.activePageStartPos+t}px)`}],i),this.previousPage.element.animate([{transform:this.previousPage.element.style.transform},{transform:`translateX(${this.previousPageStartPos+t}px)`}],i),this.nextPage.element.animate([{transform:this.nextPage.element.style.transform},{transform:`translateX(${this.nextPageStartPos+t}px)`}],i)}this.parent.element.style.userSelect="",this.parent.parent.startAutoplay()}}}class s{constructor(t,e,s,i){this.parent=t,this.fromIndex=e,this.targetIndex=s,this.direction=i}get fromPage(){return this.parent.pages[this.fromIndex]}get targetPage(){return this.parent.pages[this.targetIndex]}slide(t,e=function(){}){setTimeout((()=>{e()}),t-10);const s={duration:t,easing:"cubic-bezier(.46,.15,.31,.88)"},i=this.parent.element.getBoundingClientRect().height,a=this.targetPage.element.getBoundingClientRect().height;console.log(i),console.log(a);const n=0-this.targetPage.element.scrollWidth*this.direction,r=this.fromPage.element.scrollWidth*this.direction;this.parent.element.animate([{height:i+"px"},{height:a+"px"}],s),this.fromPage.element.animate([{transform:"translateX(0px)"},{transform:`translateX(${n}px)`}],s),this.targetPage.element.animate([{transform:`translateX(${r}px)`},{transform:"translateX(0px)"}],s)}fade(t,e=function(){}){const s={duration:t,easing:"cubic-bezier(.2,.36,.07,.88)"},i=this.parent.element.getBoundingClientRect().height,a=this.targetPage.element.getBoundingClientRect().height;this.parent.element.animate([{height:i+"px"},{height:a+"px"}],s).onfinish=t=>{e()},this.fromPage.element.animate([{transform:"translate3d(0px, 0px, 0px)",opacity:1},{transform:"translate3d(0px, 0px, 0px)",opacity:0}],Object.assign(Object.assign({},s),{duration:.5*t})).onfinish=e=>{this.fromPage.element.animate([{transform:"translate3d(0px, 0px, 0px)",opacity:0},{transform:"translate3d(0px, 0px, 0px)",opacity:0}],{duration:.5*t}),this.targetPage.element.animate([{transform:"translate3d(0px, 0px, 0px)",opacity:0},{transform:"translate3d(0px, 0px, 0px)",opacity:1}],Object.assign(Object.assign({},s),{duration:.5*t}))}}}const i={autoCreateInstances:!0,autoGenerateId:!0,id:void 0};class a{constructor(t,e=i){let s="string"==typeof t?document.querySelector(t):t;s&&(this.element=s,this.id=e.id?e.id:void 0,this.id&&(this.element.id=this.id))}static get instances(){return this.registry[this.className]?this.registry[this.className]:[]}static register(t){this.registry[this.className]||(this.registry[this.className]=[]),this.registry[this.className].push(t)}static init(t,e=i){if(this.config.autoCreateInstances){const s=document.querySelectorAll(t||this.defaultSelector);for(let t=0;t<s.length;t++){const i=s[t];let a;e.autoGenerateId&&(a=i.id?i.id:`${this.className}-${this.instances.length}`),this.register(new this(i,Object.assign(Object.assign({},e),{id:a})))}return s.length}return 0}}a.className="component",a.defaultSelector=".component",a.registry={},a.config=i;class n extends a{constructor(t,e,s){super(s),this.parent=t,this.index=e}get isActive(){return this.index===this.parent.activePageIndex}get isFirst(){return this.index===this.parent.firstPageIndex}get isLast(){return this.index===this.parent.lastPageIndex}get isPrevious(){return this.index===this.parent.previousPageIndex}get isNext(){return this.index===this.parent.nextPageIndex}update(){this.element.classList.remove("active"),this.element.classList.remove("previous"),this.element.classList.remove("next"),this.isActive?this.element.classList.add("active"):this.isPrevious?this.element.classList.add("previous"):this.isNext&&this.element.classList.add("next")}}class r extends a{constructor(t,e){super(e),this.parent=t,this.pages=[],this.initPages()}get activePageIndex(){return this.parent.activePageIndex}set activePageIndex(t){this.parent.activePageIndex=t}get firstPageIndex(){return 0}get lastPageIndex(){return this.pages.length-1}get nextPageIndex(){return this.activePageIndex===this.lastPageIndex?0:this.activePageIndex+1}get previousPageIndex(){return this.activePageIndex===this.firstPageIndex?this.lastPageIndex:this.activePageIndex-1}get activePage(){return this.pages.find((t=>t.isActive))}get nextPage(){return this.pages.find((t=>t.isNext))}get previousPage(){return this.pages.find((t=>t.isPrevious))}get firstPage(){return this.pages[this.firstPageIndex]}get lastPage(){return this.pages[this.lastPageIndex]}initPages(){const t=this.element.querySelectorAll(this.parent._config.pageSelector);for(let e=0;e<t.length;e++){const s=t[e];this.pages.push(new n(this,e,s))}if(0===t.length){let t=document.createElement("div");t.setAttribute("class","page"),this.element.appendChild(t),this.pages.push(new n(this,0,t))}}updatePages(){for(const t of this.pages)t.update()}addPage(t,e){let s,i=new n(this,t,e);if(this.pages[t])s=this.pages[t].element,s.before(i.element),t<=this.activePageIndex&&(this.activePageIndex=this.activePageIndex+1);else if(0===this.pages.length)this.element.appendChild(i.element),this.activePageIndex=0;else{if(t!==this.pages.length)return;s=this.pages[t-1].element,s.after(i.element),t<=this.activePageIndex&&(this.activePageIndex=this.activePageIndex+1)}this.pages.splice(t,0,i);for(let t=0;t<this.pages.length;t++)this.pages[t].index=t;this.updatePages()}removeAllPages(){this.pages=[],this.element.innerHTML=""}removePage(t){this.pages[t]&&(this.pages[t].element.remove(),this.pages.splice(t,1),this.updatePages())}}r.className="pages";class o extends a{constructor(t,e,s){super(s),this.parent=t,this.target=e,this.element.dataset.target=e+"",this.initEvents(),this.update()}initEvents(){this.element.addEventListener("click",(()=>{this.parent.targetComponent.goTo(this.target),this.parent.targetComponent.resetAutoplay()}))}update(){const t="number"==typeof this.target?this.target:parseInt(this.target);isNaN(t)||(this.element.classList.remove("active"),t===this.parent.targetComponent.activePageIndex&&this.element.classList.add("active"))}}class h extends a{constructor(t,e){super(e),this.targetComponent=t,this.initButtons()}initButtons(){this.buttons=[];const t=this.element.querySelectorAll("button");let e=[],s=[];for(const i of t)i.hasAttribute("data-target")?e.push(i):s.push(i);for(let t=0;t<s.length;t++){const e=s[t];this.buttons.push(new o(this,t,e))}for(const t of e)this.buttons.push(new o(this,t.dataset.target,t))}updateButtons(){for(const t of this.buttons)t.update()}}const g={transition:"slide",transitionDuration:500,autoplay:!1,autoplayDuration:3e3,pageContainerSelector:".pages",pageSelector:".page",controlSelector:".control",draggable:!0};class l extends a{constructor(t,s={}){super(t),this.initConfig(s),this.initPageContainer(),this.initControls(),this.initExternalControls(),this.activePageIndex=this.element.dataset.active?parseInt(this.element.dataset.active):0,"slide"!==this.transition&&(this.draggable=!1),this.draggable&&(this.pageDrag=new e(this.pageContainer)),this.startAutoplay()}get totalPages(){return this.pageContainer.pages.length}get activePageIndex(){return parseInt(this.element.dataset.active)}set activePageIndex(t){const e=this.activePageIndex;this.element.dataset.active=t.toString(),this.pageContainer.updatePages();for(const t of this.controls)t.updateButtons();this.onActivePageChanged&&this.onActivePageChanged(t,e)}get transition(){return this.element.dataset.transition}set transition(t){this.element.dataset.transition=t,this._config.transition=t}get transitionDuration(){return parseInt(this.element.dataset.transitionDuration)}set transitionDuration(t){this.element.dataset.transitionDuration=t.toString()}get autoplay(){return"true"===this.element.dataset.autoplay}set autoplay(t){let e;e="string"==typeof t?"true"===t.toLowerCase():t,this.element.dataset.autoplay=e?"true":"false"}get autoplayDuration(){return parseInt(this.element.dataset.autoplayDuration)}set autoplayDuration(t){this.element.dataset.autoplayDuration=t.toString()}get draggable(){return"true"===this.element.dataset.draggable}set draggable(t){let e;e="string"==typeof t?"true"===t.toLowerCase():t,this.element.dataset.draggable=e?"true":"false"}initConfig(t){const e=Object.assign(Object.assign({},this.element.dataset),t);this._config=g,this.transition=e.transition?e.transition:this._config.transition,this.transitionDuration=e.transitionDuration?parseInt(e.transitionDuration):this._config.transitionDuration,this.autoplay=e.autoplay?e.autoplay:this._config.autoplay,this.autoplayDuration=e.autoplayDuration?parseInt(e.autoplayDuration):this._config.autoplayDuration,this.draggable=e.draggable?e.draggable:this._config.draggable,this.isTransitioning=!1,this.isPaused=!1}initPageContainer(){let t=this.element.querySelector(this._config.pageContainerSelector);t||(t=document.createElement("div"),t.setAttribute("class",this._config.pageContainerSelector.replace(".","")),this.element.appendChild(t)),this.pageContainer=new r(this,t)}initControls(){this.controls||(this.controls=[]);const t=this.element.querySelectorAll(this._config.controlSelector);for(const e of t)this.controls.push(new h(this,e))}initExternalControls(){this.controls||(this.controls=[]);const t=document.querySelectorAll(`[data-control="#${this.id}"]`);for(const e of t)this.controls.push(new h(this,e))}startAutoplay(){this.autoplay&&(this.isPaused=!1,this.autoplayInterval=setInterval((()=>{this.isPaused||this.forward()}),this.autoplayDuration))}stopAutoplay(){this.autoplayInterval&&(clearInterval(this.autoplayInterval),this.autoplayInterval=null,this.isPaused=!0)}resetAutoplay(){this.autoplay&&(this.stopAutoplay(),this.startAutoplay())}back(t){this.goTo("back",t)}forward(t){this.goTo("forward",t)}goTo(t,e){let i;if("back"===t)i=this.pageContainer.previousPageIndex;else if("forward"===t)i=this.pageContainer.nextPageIndex;else if("number"==typeof t)i=t;else if(isNaN(parseInt(t))){if(!isNaN(parseInt(t)))return;{const e=this.pageContainer.pages.find((e=>e.id===t||`#${e.id}`===t));if(!e)return;i=e.index}}else i=parseInt(t);if(this.activePageIndex!==i&&this.pageContainer.pages[i])if("none"!==this.transition){let a=1;i<this.activePageIndex&&(a=-1),"forward"===t&&(a=1),"back"===t&&(a=-1);const n=new s(this.pageContainer,this.activePageIndex,i,a);"slide"===this.transition?n.slide(this.transitionDuration,(()=>{this.activePageIndex=i,e&&e()})):"fade"===this.transition&&n.fade(this.transitionDuration,(()=>{this.activePageIndex=i,e&&e()}))}else this.activePageIndex=i,e&&e()}addPage(t,e){this.pageContainer.addPage(t,e)}removeAllPages(){this.pageContainer.removeAllPages()}removePage(t){this.pageContainer.removePage(t)}}return l.className="paged-component",l.defaultSelector=".paged-component",l.init(),t})()}));
//# sourceMappingURL=virgo.bundle.min.js.map